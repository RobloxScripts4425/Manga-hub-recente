local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/shlexware/Orion/main/source')))()
local Window = OrionLib:MakeWindow({Name = "Manga Hub 4.2.1", HidePremium = false, SaveConfig = true, ConfigFolder = "MangaHub"})

-- Aba "Jogador"
local PlayerTab = Window:MakeTab({
    Name = "Jogador",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

-- Botão +30 Velocidade
PlayerTab:AddButton({
    Name = "+30 Velocidade",
    Callback = function()
        game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = game.Players.LocalPlayer.Character.Humanoid.WalkSpeed + 30
    end    
})

-- Botão +30 Pulo
PlayerTab:AddButton({
    Name = "+30 Pulo",
    Callback = function()
        game.Players.LocalPlayer.Character.Humanoid.JumpPower = game.Players.LocalPlayer.Character.Humanoid.JumpPower + 30
    end    
})

-- Botão Pulo e Velocidade Normal
PlayerTab:AddButton({
    Name = "Pulo e Velocidade Normal",
    Callback = function()
        game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = 16
        game.Players.LocalPlayer.Character.Humanoid.JumpPower = 50
    end    
})

-- Aba "Troll" para Fling e coleta de itens
local FlingTab = Window:MakeTab({
    Name = "Troll",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

local PlayerName
FlingTab:AddTextbox({
    Name = "Nome do Jogador",
    Default = "",
    TextDisappear = true,
    Callback = function(Value)
        PlayerName = string.lower(Value)  -- Convertendo o nome para minúsculas para evitar problemas de case sensitivity
    end    
})

-- Função de Fling ajustada
FlingTab:AddButton({
    Name = "Ativar Fling",
    Callback = function()
        local targetPlayer = nil
        -- Procurar o jogador com base no início do nome, nick de exibição e nick real
        for _, player in pairs(game.Players:GetPlayers()) do
            local realName = string.lower(player.Name)
            local displayName = string.lower(player.DisplayName)
            if realName:sub(1, #PlayerName) == PlayerName or displayName:sub(1, #PlayerName) == PlayerName then
                targetPlayer = player
                break
            end
        end

        if targetPlayer then
            local flingSpeed = 1999 -- Velocidade do fling
            local character = game.Players.LocalPlayer.Character
            local hrp = character:FindFirstChild("HumanoidRootPart")
            
            if hrp and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local targetHRP = targetPlayer.Character.HumanoidRootPart

                -- Função para aplicar força ao jogador alvo
                local function applyFling()
                    while true do
                        if (character.Humanoid.Health > 0 and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart")) then
                            -- Aplicar força alternadamente
                            targetHRP.Velocity = (targetHRP.Position - hrp.Position).unit * flingSpeed
                            wait(0.01) -- Intervalo de tempo para atualizar a posição
                        else
                            break
                        end
                    end
                end

                applyFling()
            end
        else
            print("Jogador não encontrado")
        end
    end    
})

-- Função para desativar o fling e zerar a saúde do jogador
FlingTab:AddButton({
    Name = "Parar Fling",
    Callback = function()
        game.Players.LocalPlayer.Character.Humanoid.Health = 0
    end    
})

-- Botão "Pegar basketball" na aba "Troll"
FlingTab:AddButton({
    Name = "Pegar basketball",
    Callback = function()
        local character = game.Players.LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            character.HumanoidRootPart.CFrame = CFrame.new(Vector3.new(-138.80, 2.50, 98.85))
        end
    end    
})

-- Função para verificar a colisão e coletar itens (Atualizado para o contexto)
local function collectItems()
    local character = game.Players.LocalPlayer.Character
    if not character or not character:FindFirstChild("HumanoidRootPart") then
        return
    end

    local humanoidRootPart = character.HumanoidRootPart
    local itemRadius = 10 -- Distância para detectar itens próximos
    local collectSpeed = 0.1 -- Intervalo de tempo entre tentativas de coleta

    while true do
        -- Atualiza o status da GUI
        if ScreenGui:FindFirstChild("StatusLabel") then
            ScreenGui.StatusLabel.Text = "Coletando itens..."
        end

        -- Encontra objetos próximos ao jogador
        local items = workspace:FindPartsInRegion3(
            Region3.new(
                humanoidRootPart.Position - Vector3.new(itemRadius, itemRadius, itemRadius),
                humanoidRootPart.Position + Vector3.new(itemRadius, itemRadius, itemRadius)
            ),
            nil, -- Ignora todos os tipos de objetos
            math.huge -- Ignora o número máximo de objetos encontrados
        )

        for _, item in pairs(items) do
            if item:IsA("BasePart") and item.Name ~= "" then
                -- Verifica se o item pode ser clicado
                if item:FindFirstChild("ClickDetector") then
                    item.ClickDetector.MouseClick:Fire()
                end
            end
        end

        -- Espera antes de tentar coletar itens novamente
        wait(collectSpeed)
    end
end

-- Inicia a coleta de itens ao clicar no botão
FlingTab:AddButton({
    Name = "Iniciar Coleta de Itens",
    Callback = function()
        collectItems()
    end    
})

-- Aba "Jogo" para abrir configurações do jogo (similar ao Dex)
local GameTab = Window:MakeTab({
    Name = "Jogo",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

-- Botão para abrir as configurações do jogo
GameTab:AddButton({
    Name = "Config do Jogo",
    Callback = function()
        -- Carregando o Dex Explorer para abrir configurações do jogo
        loadstring(game:HttpGet("https://raw.githubusercontent.com/peyton2465/Dex/master/out.lua"))()
    end    
})

OrionLib:Init()
